<!DOCTYPE html>
<html lang="en">
<title>Quadrotor Simulation</title>
<link rel="icon" type="image/png" href="/images/quad16.png">
<link rel="stylesheet" href="main.css">
<meta name="viewport" content="width=device-width, initial-scale=1.0,minimum-scale=1.0">
<meta name="description" content="An interactive 3D quadrotor simulation">

{{ header.html }}

<script type="module" src="js/mathutils.js"></script>
<script type="module" src="js/quadsim.js"></script>

<h1 id="simtitle">Quadrotor Simulation</h1>
<div id="sim-inst">WASD and arrow keys to fly around, left click to pan, right click to set a goal</div>

<div class="simdiv" id="mainsim">
  <div class="simdiv" id="simcell">
    <canvas id="sim"></canvas>
    <div class="simdiv" id="speed"></div>
    <div class="simdiv" id="info"></div>
    <div class="simdiv" id="info2"></div>
  </div>

  <div class="simdiv" id="simcellsettings" style="text-align: center">
    <h2 class="simheading simtop"> Attitude Control </h2>

    <select id="controltype" title="Select the type of attitude controller. Mouse over each for a short description.">
      <option value="cso3" title="Continuous error metric on SO(3). Strongest response at 90 degree error. Smooth but slow to respond at large angle errors. Does not always follow straight lines.">Continuous SO(3)</option>
      <option value="dso3" title="Discontinuous error metric on SO(3). Strength of response is proportional to angle error. Does not always follow straight lines.">Discontinuous SO(3)</option>
      <option value="redatt" title="Decomposes error into acceleration vector and yaw components. Always takes straight line path.">Reduced Attitude</option>
      <option value="fblin" title="Completely linearizes the nonlinear dynamics leading to a theoretically perfect error response. Less robust.">Feedback Linearization</option>
    </select>

    <h2 class="simheading"> Test Cases </h2>
      <button type="button" class="testbut" id="homebut" title="Bring the quadrotor back to the center">Return to Origin</button>
      <button type="button" class="testbut" id="step1" title="Quickly change direction (angle)">Quick Direction Change</button>
      <button type="button" class="testbut" id="step2" title="Simultaneously change position and yaw by 180 degrees">Position Yaw Step</button>
      <button type="button" class="testbut" id="step3" title="Simultaneously step in both the X and Y directions">Diagonal Step</button>

    <h2 class="simheading"> Settings </h2>
      <h3 class="simheading simtop"> Camera </h3>
      <button type="button" class="cambut" id="resetcambut" title="Reset camera settings">Default Cam</button>

      <div>
        <div style="display: flex">
          <button type="button" class="cambut" id="sidecambut" title="View from the side; best for Position Yaw Step">Side</button>
          <button type="button" class="cambut" id="diagcambut" title="Diagonal view; best for Diagonal Step">Diagonal</button>
        </div>
        <div style="display: flex">
          <button type="button" class="cambut" id="topcambut" title="Top down orthographic view">Top Ortho</button>
          <button type="button" class="cambut" id="sidecamorthobut" title="Sideways orthographic view">Side Ortho</button>
        </div>
      </div>
      <div title="Camera orbits quadrotor">Follow Drone <input type="checkbox" id="followbox"/></div>
      <h3 class="simheading"> Control </h3>
      <div id="settingsdiv"></div>
      <br>
      <button type="button" class="testbut" id="resetdefbut" title="Reset all control settings to their defaults">Reset to Defaults</button>
  </div>
</div>
